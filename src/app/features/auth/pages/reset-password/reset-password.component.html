<app-auth-layout>
  <div class="reset-password">
    <div class="reset-password__header">
      <h1 class="sol-title">Redefinir Senha</h1>
      <p class="sol-subtitle">Digite sua nova senha para redefinir o acesso à sua conta</p>
    </div>

    @if (tokenValid) {
      <form [formGroup]="form" class="reset-password__form" (ngSubmit)="onSubmit()">
        <app-input
          type="password"
          id="password"
          placeholder="Nova senha"
          [error]="!!(form.get('password')?.errors && form.get('password')?.touched)"
          [errorMessage]="getErrorMessage('password')"
          formControlName="password"
        />

        <app-input
          type="password"
          id="confirmPassword"
          placeholder="Confirmar senha"
          [error]="!!((form.errors?.['passwordMismatch'] && form.get('confirmPassword')?.touched))"
          [errorMessage]="getErrorMessage('confirmPassword')"
          formControlName="confirmPassword"
        />

        <button type="submit" class="sol-button primary" [disabled]="form.invalid || loading.isLoading('reset-password')">
          @if (loading.isLoading('reset-password')) {
            <app-loading [size]="4" [inline]="true" />
          }
          Redefinir Senha
        </button>
      </form>

      <div class="reset-password__footer">
        <p>Lembrou sua senha? <a [routerLink]="['/sign-in']" class="sol-link">Faça login</a></p>
      </div>
    } @else {
      <div class="reset-password__loading">
        <app-loading [size]="8" />
        <p>Validando token...</p>
      </div>
    }
  </div>
</app-auth-layout>
